<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>前端测试页面</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .test-card {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .loading {
            background-color: #fff3cd;
            color: #856404;
        }
    </style>
</head>
<body>
    <h1>企业前端系统测试页面</h1>
    
    <div class="test-card">
        <h2>API连接测试</h2>
        <button onclick="testAPI()">测试API连接</button>
        <div id="api-status" class="status loading">等待测试...</div>
    </div>
    
    <div class="test-card">
        <h2>内存数据测试</h2>
        <button onclick="testMemoryAPI()">测试内存数据API</button>
        <div id="memory-status" class="status loading">等待测试...</div>
        <div id="memory-data"></div>
    </div>
    
    <div class="test-card">
        <h2>页面导航测试</h2>
        <button onclick="testNavigation()">测试页面导航</button>
        <div id="nav-status" class="status loading">等待测试...</div>
    </div>
    
    <div class="test-card">
        <h2>JavaScript初始化测试</h2>
        <div id="js-status" class="status loading">等待测试...</div>
    </div>

    <script>
        // 测试API连接
        async function testAPI() {
            const statusDiv = document.getElementById('api-status');
            statusDiv.className = 'status loading';
            statusDiv.textContent = '正在测试API连接...';
            
            try {
                const response = await fetch('http://localhost:8003/health');
                const data = await response.json();
                
                if (data.status === 'healthy') {
                    statusDiv.className = 'status success';
                    statusDiv.textContent = '✅ API连接成功，系统状态正常';
                } else {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = '❌ API连接失败，系统状态异常';
                }
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = '❌ API连接失败: ' + error.message;
            }
        }
        
        // 测试内存数据API
        async function testMemoryAPI() {
            const statusDiv = document.getElementById('memory-status');
            const dataDiv = document.getElementById('memory-data');
            statusDiv.className = 'status loading';
            statusDiv.textContent = '正在测试内存数据API...';
            dataDiv.innerHTML = '';
            
            try {
                const response = await fetch('http://localhost:8003/api/v1/memory/dashboard-stats');
                const data = await response.json();
                
                statusDiv.className = 'status success';
                statusDiv.textContent = '✅ 内存数据API连接成功';
                
                dataDiv.innerHTML = `
                    <h3>数据概览:</h3>
                    <ul>
                        <li>产品总数: ${data.overview?.total_products || 0}</li>
                        <li>用户总数: ${data.overview?.total_users || 0}</li>
                        <li>行为总数: ${data.overview?.total_behaviors || 0}</li>
                        <li>类别数量: ${data.overview?.categories || 0}</li>
                    </ul>
                `;
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = '❌ 内存数据API失败: ' + error.message;
            }
        }
        
        // 测试页面导航
        function testNavigation() {
            const statusDiv = document.getElementById('nav-status');
            statusDiv.className = 'status loading';
            statusDiv.textContent = '正在测试页面导航...';
            
            // 检查是否存在导航元素
            const navLinks = document.querySelectorAll('.nav-link');
            const pageContents = document.querySelectorAll('.page-content');
            
            statusDiv.innerHTML = `
                <div>导航链接数量: ${navLinks.length}</div>
                <div>页面内容数量: ${pageContents.length}</div>
                <div>导航链接详情:</div>
                <ul>
                    ${Array.from(navLinks).map(link => `<li>${link.textContent} (data-page: ${link.getAttribute('data-page')})</li>`).join('')}
                </ul>
                <div>页面内容详情:</div>
                <ul>
                    ${Array.from(pageContents).map(page => `<li>${page.id} (class: ${page.className})</li>`).join('')}
                </ul>
            `;
            
            if (navLinks.length > 0 && pageContents.length > 0) {
                statusDiv.className = 'status success';
            } else {
                statusDiv.className = 'status error';
            }
        }
        
        // 页面加载完成后测试JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            const jsStatus = document.getElementById('js-status');
            jsStatus.className = 'status success';
            jsStatus.textContent = '✅ JavaScript初始化成功';
            
            console.log('测试页面JavaScript加载完成');
        });
    </script>
</body>
</html>